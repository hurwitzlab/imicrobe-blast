BootStrap: docker
From: ubuntu:latest

%setup
    mkdir "$SINGULARITY_ROOTFS/imicrobe-blast"
    mount --no-mtab --bind .. "$SINGULARITY_ROOTFS/imicrobe-blast"

%runscript
    exec blastn "$@"

%post
    apt-get update
    apt-get install -y git locales ncbi-blast+ python3 python3-pip
    locale-gen en_US.UTF-8

    ## this caused failure upgrading to pip 10.0
    ##pip3 install --upgrade pip

    cd /imicrobe-blast
    pip3 install -r requirements-container.txt

    mkdir /home1
    mkdir /work
    mkdir /scratch
